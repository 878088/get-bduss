<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel="shortcut icon" href="data:image/x-icon;base64,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">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="author" content="Banka2017 (https://nest.moe)">
        <meta name="description" content="扫码登录获取BDUSS">
        <meta name="keywords" content="百度,登录,百度登录,BDUSS,BDUSS在线获取">
        <title>扫码登录获取BDUSS</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">
        <script src="https://cdn.jsdelivr.net/npm/axios@0.19.2/dist/axios.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue-router@3.3.4/dist/vue-router.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
    </head>
    <body>
        <div id="app">
            <div class="container">
                <div class="col-md-8 offset-md-2">
                    <div class="my-4"></div>
                    <div class="alert alert-info" role="alert" v-if="$route.params.callbackURL">
                        将跳转到: <a :href="`//`+host($route.params.callbackURL)" class="alert-link">{{ host($route.params.callbackURL) }}</a>
                    </div>
                    <div class="card text-center" v-if="[0, 1].indexOf(status) !== -1">
                        <div class="card-body">
                            <div class="text-right"><span role="button" @click="fullMode = !fullMode" :class="`badge badge-` + (fullMode ? 'dark' : 'light')">更多</span></div>
                            <div class="spinner-border" role="status" v-if="loading">
                                <span class="sr-only">Loading...</span>
                            </div>
                            <p class="text-center" v-else-if="(!status || !btnType) && status!=2">
                                <img :src="success()" alt="qrcode-success">
                                <br>扫描成功<br>请确认登录
                            </p>
                            <img class="img-fluid" alt="QRcode" :src="`//`+qrCodeUrl" v-else-if="btnType">
                            <div class="my-4"></div>
                            <div v-if="!loading">
                                <a class="btn btn-primary btn-lg btn-block" @click="btnType=false;loading=true" :href="`https://wappass.baidu.com/wp/?qrlogin=&amp;sign=`+sign" target="_blank">
                                    <span>网页授权</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <template v-else>
                        <div :class="`card text-center `+(status==2 ? 'border-success' : 'border-danger' )">
                            <div class="card-body">
                                <div v-if="bduss">
                                    <h3>BDUSS获取成功</h3>
                                    <div class="my-4"></div>
                                    <div v-if="status">
                                        <div class="input-group input-group-lg">
                                            <input type="text" :value="bduss" aria-label="Large" class="form-control" aria-describedby="copied">
                                            <div class="input-group-append">
                                                <button :class="`btn btn-outline-secondary` + (copied === 'bduss' ? ' active' : '')" type="button" id="copy" :data-clipboard-text="bduss" @click="copied = 'bduss'">{{ copied === 'bduss' ? '已复制' : '复制' }}</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="my-4"></div>
                                </div>
                                <div v-else>
                                    <h3>BDUSS获取失败</h3>
                                    <div class="my-4"></div>
                                </div>
                                <button class="btn btn-primary btn-lg btn-block" @click="init" v-if="!$route.params.callbackURL">
                                    <span>再次获取</span>
                                </button>
                            </div>
                        </div>
                        <template v-if="fullMode && bduss">
                            <div class="my-4"></div>
                            <div class="card">
                                <div class="card-body">
                                    <template v-for="(value, key) in fullModeData">
                                        <template v-if="key !== 'stokenList'">
                                            <span class="font-weight-bold">{{ key }}: </span><span id="copy" class="text-monospace" role="button" :data-clipboard-text="fullModeData[key]" @click="copied = key">{{ value }}</span> <span class="badge badge-dark" v-if="copied === key">copied</span><br>
                                        </template>
                                        <template v-else>
                                            <label class="font-weight-bold">stokenList:</label>
                                            <ul v-for="(v, k) in value">
                                                <li><span class="font-weight-bold">{{ k }}: </span><span id="copy" class="text-monospace" role="button" :data-clipboard-text="value[k]" @click="copied = k">{{ v }}</span> <span class="badge badge-dark" v-if="copied === k">copied</span></li>
                                            </ul>
                                        </template>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </template>
                    <div class="my-4"></div>
                    <div class="card border-info">
                        <div class="card-body">
                            <h3>提示</h3>
                            <ul>
                                <li>可直接点击 "网页授权" 并在新打开页授权，无需客户端扫码</li>
                                <li>点击右上角 "更多" 徽章，可获取更多信息，点击字符即可复制</li>
				                <li>本站使用Google Analytics</li>
                                <li>打开百度页面时请使用移动设备或将浏览器ua设置为移动设备的ua</li>
                                <li>本页 <a href="https://github.com/BANKA2017/get-bduss" target="_blank">GitHub 仓库</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="text-center">Created by <a href="https://nest.moe">BANKA</a> with ♥</div>
                </div>
            </div>
        </div>
	<script>
	    window.ga_tid = "UA-90617066-7";
	    window.ga_api = "https://ga.nest.moe";
	</script>
	<script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script>
        <script>
            'use strict';
            let cancel
            let CancelToken
            CancelToken = axios.CancelToken
            new Vue({
                el: '#app',
                data: {
                    qrCodeUrl: "",
                    sign: "",
                    bduss: "",
                    loading: true,
                    status: 1,
                    btnType: true,
                    copied: '',
                    fullMode: false,
                    fullModeData: {},
                    api: "https://api.nest.moe/baidu/bduss/v2/",
                },
                router: new VueRouter({
                    routes: [
                        {
                            path: '/:callbackURL',
                        }
                    ]
                }),
                mounted: function() {
                    new ClipboardJS('#copy');
                    this.init();
                },
                watch: {
                    "status": function () {
                        if(this.status === 2 && this.bduss && this.$route.params.callbackURL){
                            setTimeout(() => {window.location.replace(atob(this.$route.params.callbackURL) + '&bduss=' + this.bduss)}, 5000);
                        }
                    },
                    "fullMode": function () {
                        this.init()
                    }
                },
                methods: {
                    init: function(){
                        if(cancel) {
                            cancel()
                        }
                        this.loading = true;
                        this.status = 1;
                        this.bduss = this.sign = this.qrCodeUrl = "";
                        this.loading = this.btnType = true;
                        axios.get(this.api + '?m=getqrcode', {
                            cancelToken: new CancelToken(function executor(c) {
                                cancel = c
                            })
                        }).then(response => {
                            this.qrCodeUrl = response.data.data.imgurl;
                            this.sign = response.data.data.sign;
                            this.loading = false;
                            this.url = null;
                            this.copied = '';
                            this.req();
                        }).catch(e => {
                            if (!axios.isCancel(e)) {
                                this.status = -1;
                            }
                        });
                    },
                    req: function(){
                        if(cancel) {
                            cancel()
                        }
                        axios.get(this.api + '?m=getbduss&sign=' + this.sign + (this.fullMode ? "&full" : ""), {
                            cancelToken: new CancelToken(function executor(c) {
                                cancel = c
                            })
                        }).then(response => {
                            //-1 更换二维码
                            //0 进入下一步
                            //1 无需操作
                            //2 已确认
                            this.bduss = response.data.data.bduss;
                            this.status = response.data.data.status;
                            this.loading = false;
                            if (response.data.data.data) {
                                this.fullModeData = response.data.data.data
                            }
                            if(this.status >= 0 && this.status < 2){
                                this.req();
                            }
                        }).catch(e => {
                            if (!axios.isCancel(e)) {
                                this.status = -1;
                            }
                        });
                    },
                    host: function(url){
                        return (new URL(atob(decodeURI(url)))).host
                    },
                    success: function(){
                        return 'data:image/svg+xml;base64,' + btoa('<svg xmlns="http://www.w3.org/2000/svg" role="img" version="1.1" x="0px" y="0px" width="36px" height="36px"><circle fill="#3C76FF" cx="18" cy="18" r="18" /><path fill="#FFFFFF" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M10.45,17.167l6,5.75 L10.45,17.167z" /><path fill="#FFFFFF" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M16.45,22.917l11-10 L16.45,22.917z" /></svg>');
                    }
                }
            })
        </script>
    </body>
</html>
